<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Informe de Actividad - Santa María Tlahuitoltepec</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Arial', sans-serif;
    }

    body {
      background-color: #f5f5f5;
      display: flex;
      min-height: 100vh;
    }

    /* Sidebar */
    .sidebar {
      width: 250px;
      background-color: #002147;
      color: white;
      transition: all 0.3s;
      position: fixed;
      height: 100vh;
      z-index: 1000;
    }

    .sidebar-header {
      padding: 20px;
      background-color: #001a36;
      text-align: center;
    }

    .sidebar-header h3 {
      color: white;
      font-size: 1.2em;
      margin: 0;
    }

    .sidebar-menu {
      padding: 20px 0;
    }

    .sidebar-menu ul {
      list-style: none;
    }

    .sidebar-menu li {
      position: relative;
    }

    .sidebar-menu a {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 15px 20px;
      color: #b8c7ce;
      text-decoration: none;
      transition: all 0.3s;
      border-left: 3px solid transparent;
      white-space: normal;
    }

    .sidebar-menu a i {
      flex-shrink: 0;
      min-width: 20px;
      text-align: center;
    }

    .sidebar-menu a:hover,
    .sidebar-menu a.active {
      color: white;
      background-color: #1a3a6a;
      border-left: 3px solid #ff7f00;
    }

    /* Main Content */
    .main-content {
      margin-left: 250px;
      width: calc(100% - 250px);
      transition: all 0.3s;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    /* Header */
    .top-navbar {
      background-color: white;
      padding: 15px 20px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
    }

    .toggle-sidebar {
      background: none;
      border: none;
      color: #002147;
      font-size: 20px;
      cursor: pointer;
    }

    .user-menu {
      display: flex;
      align-items: center;
    }

    .user-menu img {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin-right: 10px;
    }

    .user-menu span {
      color: #002147;
      font-weight: bold;
    }

    /* Icono de usuario flotante */
    #iconoPerfilContainer {
      position: fixed;
      top: 18px;
      right: 28px;
      z-index: 10000;
    }

    #iconoPerfil {
      font-size: 32px;
      color: #1B396A;
      cursor: pointer;
      transition: color 0.2s, transform 0.2s;
    }

    #iconoPerfil:hover {
      color: #ff7f00;
      transform: scale(1.08);
    }

    /* Logos (solo pantalla) */
    .header-logos {
      background-color: #f5f5f5;
      padding: 20px 10px;
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 20px;
    }

    @media print {
      .header-logos {
        display: none !important;
      }
    }

    .logo-enlace img {
      height: 60px;
      transition: transform 0.2s;
    }

    .logo-enlace img:hover {
      transform: scale(1.05);
    }

    /* Encabezado de unidad (solo pantalla) */
    .unidad-header {
      background-color: #002147;
      color: white;
      padding: 15px;
      text-align: center;
      font-size: 1.2em;
      margin-bottom: 20px;
    }

    @media print {
      .unidad-header {
        display: none !important;
      }
    }

    /* Contenido del informe - MODIFICADO */
    .contenido-informe {
      width: 90%;
      max-width: 800px;
      padding: 15px;
      margin: 15px auto;
      background-color: white;
    }

    .encabezado {
      width: 100%;
      border-collapse: collapse;
      font-family: Arial, sans-serif;
      font-size: 14px;
       border: 2px solid #000; 
    }

    .encabezado td,
    .encabezado th {
      border: 1px solid #999;
      padding: 5px;
      vertical-align: top;
        border: 1px solid #000 !important;
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
    }

    .logo {
      width: 100px;
      text-align: center;
    }

    .logo img {
      width: 80px;
      height: auto;
    }

    .titulo {
      font-weight: bold;
    }

    .derecha {
      width: 200px;
    }

    input[type="text"], input[type="number"], input[type="date"] {
      width: 100%;
      box-sizing: border-box;
      padding: 5px 8px;
      border-radius: 4px;
      border: 1px solid #bdbdbd;
      font-size: 1em;
    }

    .header-inputs {
      display: flex;
      gap: 20px;
      margin-bottom: 18px;
      justify-content: center;
    }

    @media print {
      button,
      input,
      .barra-blanca,
      .barra-secundaria,
      .barra-informativa,
      .btn-fixed,
      .sidebar,
      .top-navbar,
      #iconoPerfilContainer {
        display: none !important;
      }
      
      .main-content {
        margin-left: 0 !important;
        width: 100% !important;
      }

      .print-value {
        display: inline;
        font-weight: normal;
      }

      .editable::after {
        content: attr(data-value);
        display: inline;
        margin-left: 5px;
      }
    }

    /* Firmas - MODIFICADO */


   .footer-firmas {
  display: flex;
  justify-content: center;
  align-items: flex-end;
  width: 100%;
  margin-top: auto;
  padding: 40px 0 20px;
  position: relative;
}

.footer-content {
  display: flex;
  justify-content: space-between;
  width: 100%;
  max-width: 900px;
}

.firma {
  flex: 1;
  text-align: center;
  padding: 0 10px;
}

.firma div {
  border-bottom: 1.5px solid #222;
  margin-bottom: 6px;
  height: 60px;
}

.firma span {
  font-size: 0.98em;
}

@media print {
  .footer-firmas {
    display: flex !important;
    position: absolute;
    bottom: 20px;
    left: 0;
    right: 0;
  }
}


    .tabla-estilo {
      width: 100%;
      margin-bottom: 20px;
      border-collapse: collapse;
    }

    .tabla-estilo th,
    .tabla-estilo td {
      padding: 8px;
      text-align: center;
      border: 1px solid #ddd;
    }

    .tabla-estilo th {
      background-color: #f2f2f2;
    }

    /* Footer con mapa y contacto (solo pantalla) */
    .site-footer {
      background-color: #002147;
      color: white;
      padding: 40px 0 20px;
      margin-top: auto;
      width: 100%;
    }

    .footer-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
      gap: 30px;
    }

    .footer-text {
      flex: 1;
      min-width: 300px;
    }

    .footer-text h3 {
      color: #ff7f00;
      margin-bottom: 15px;
      font-size: 1.3em;
      font-weight: bold;
    }

    .footer-text p {
      margin-bottom: 20px;
      line-height: 1.6;
    }

    .footer-map {
      flex: 1;
      min-width: 300px;
    }

    .footer-map iframe {
      width: 100%;
      height: 280px;
      border-radius: 8px;
      border: none;
      box-shadow: 0 3px 10px rgba(0,0,0,0.2);
    }

    .footer-copyright {
      text-align: center;
      margin-top: 30px;
      padding-top: 20px;
      border-top: 1px solid rgba(255,255,255,0.1);
      font-size: 0.9em;
      color: rgba(255,255,255,0.7);
    }

    .whatsapp-link img {
      width: 30px;
      height: 30px;
      transition: transform 0.3s;
    }

    .whatsapp-link img:hover {
      transform: scale(1.1);
    }

    @media print {
      .site-footer {
        display: none !important;
      }
    }

    /* Botones */
    .footer-botones {
      width: 100%;
      max-width: 800px;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 16px;
      background: #fff;
      padding: 10px 0;
      margin: 20px auto;
      z-index: 110;
    }

    .footer-botones .btn-accion {
      padding: 6px 16px;
      font-size: 14px;
      border: none;
      border-radius: 4px;
      background-color: #1B396A;
      color: white;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    .footer-botones .btn-accion:hover {
      background-color: #16305A;
    }

    @media print {
      .footer-botones {
        display: none !important;
      }
    }

    /* Responsive */
    @media (max-width: 768px) {
      .sidebar {
        margin-left: -250px;
      }
      .sidebar.active {
        margin-left: 0;
      }
      .main-content {
        width: 100%;
        margin-left: 0;
      }
      .main-content.active {
        margin-left: 250px;
        width: calc(100% - 250px);
      }
      
      .footer-container {
        flex-direction: column;
      }
      
      .footer-map {
        order: -1;
      }
      
      .footer-content {
        flex-direction: row;
        gap: 10px;
      }
      
      .firma {
        width: auto;
      }
    }
  </style>
</head>
<body>
<!-- Sidebar -->
<div class="sidebar">
  <div class="sidebar-header">
    <h3>Actividades Extraescolares</h3>
  </div>
  <div class="sidebar-menu">
    <ul>
      <li>
        <a href="#" id="link-inicio">
  <i class="fa fa-home"></i> Inicio
</a>
      </li>
      <li>
        <a href="VerEstudiantes.html">
          <i class="fa fa-users"></i> Ver Estudiantes
        </a>
      </li>
      <li>
        <a href="contancia.html">
          <i class="fa fa-file-text"></i> Constancia de Cumplimiento 
        </a>
      </li>
      <li>
        <a href="informe.html" class="menu-link">
          <i class="fa fa-file-pdf-o"></i> Informe de Actividad
        </a>
      </li>
      <li>
        <a href="resultados.html">
          <i class="fa fa-bar-chart"></i> Resultados
        </a>
      </li>
    </ul>
  </div>
</div>

<!-- Main Content -->
<div class="main-content">
  <!-- Top Navbar -->
  <div class="top-navbar">
    <button class="toggle-sidebar" id="toggle-sidebar">
      <i class="fa fa-bars"></i>
    </button>
  </div>

  <!-- Logos (solo pantalla) -->
  <div class="header-logos">
    <div class="logo-enlace">
      <a href="https://www.gob.mx/" target="_blank"><img src="https://vetla.tecnm.mx/wp-content/themes/TecNM-ITVE/images/pleca-GobMx.png" alt="GobMX"></a>
      <a href="https://www.gob.mx/sep" target="_blank"><img src="https://vetla.tecnm.mx/wp-content/themes/TecNM-ITVE/images/pleca-Educ.png" alt="SEP"></a>
      <a href="https://www.tecnm.mx" target="_blank"><img src="https://vetla.tecnm.mx/wp-content/themes/TecNM-ITVE/images/pleca-TecNM.png" alt="TecNM"></a>
      <a href="http://www.vetla.tecnm.mx/" target="_blank"><img src="https://vetla.tecnm.mx/wp-content/themes/TecNM-ITVE/images/pleca-ITVE.png" alt="ITVE"></a>
    </div>
  </div>

  <!-- Encabezado de unidad (solo pantalla) -->
  <div class="unidad-header">
    FORMATO DE RESULTADOS DE ACTIVIDADES EXTRAESCOLARES CULTURALES Y/O DEPORTIVAS
  </div>

  <!-- Contenido del informe -->
  <div class="contenido-informe">
    <table class="tabla-estilo" style="margin-bottom: 32px;">
      <tr>
        <td class="logo" rowspan="2"><img src="assets/img/sgc.jpg" alt="Logo SGC" style="opacity: 0.5;"></td>
        <td class="titulo" style="text-align: center;">Formato de Resultados de Actividades Extraescolares Culturales y/o Deportivas </td>
        <td class="derecha" style="text-align: right;">Código: TecNM-VI-PO-003-03</td>
      </tr>
      <tr>
        <td style="text-align: center;">Referencia a la Norma ISO 9001:2015 8.1, 8.2.1, &nbsp; 8.2.2</td>
        <td style="text-align: right;">Revisión: 0 <br>Página 1 de 2</td>
      </tr>
    </table>

 <h3 style="text-align:center; font-size: 16px; line-height: 1.5;">
  DEPARTAMENTO DE ACTIVIDADES EXTRAESCOLARES<br>
  OFICINA DE PROMOCIÓN CULTURAL O DEPORTIVA<br>
  ACTIVIDAD CULTURAL
</h3>

    <div style="margin-bottom: 18px;">
      <table class="tabla-estilo">
        <thead>
          <tr>
            <th>No.</th>
            <th>Nombre</th>
            <th>No. Control</th>
            <th>Carrera</th>
            <th>Sem</th>
            <th>Resultado</th>
            <th>Firma</th>
          </tr>
        </thead>
        <tbody id="tabla-cuerpo">
          <!-- Las filas se llenarán con JavaScript -->
        </tbody>
      </table>
    </div>

    <!-- Firmas - MODIFICADO -->
    <div class="footer-firmas">
      <div class="footer-content">
        <div class="firma">
          <div></div>
          <span>Promotor Cultural o Deportivo</span>
        </div>
        <div class="firma">
          <div></div>
          <span>Jefe(a) de Oficinas de Promoción</span>
        </div>
        <div class="firma">
          <div></div>
          <span>Alejandro Loma Bolaños<br>Jefe de Departamentos de Oficinas Extraescolares</span>
        </div>
      </div>
    </div>

    <!-- Botones -->
    <div class="footer-botones">
      <button class="btn-accion" onclick="window.print()">Imprimir</button>
    </div>
  </div>

  <!-- Footer con mapa y contacto (solo pantalla) -->
  <footer class="site-footer">
    <div class="footer-container">
      <!-- Información de contacto -->
      <div class="footer-text">
        <h3>Dirección</h3>
        <p>Carretera Santa María Tlahuitoltepec Km 1.5<br>Santa María Tlahuitoltepec, Oaxaca, C.P. 70280</p>
        
        <h3>Contacto</h3>
        <p>
          Email: santamaria@tecnm.mx<br>
          Teléfono: 951 123 4567
        </p>
        
        <h3>Preguntar por Whatsapp</h3>
        <a href="https://wa.me/9511234567?text=Buen%20d%C3%ADa%2C%20deseo%20informaci%C3%B3n%20" target="_blank" class="whatsapp-link">
          <img src="http://vetla.tecnm.mx/wp-content/uploads/2021/04/whatsapp.png" alt="Whatsapp">
        </a>
      </div>
      
      <!-- Mapa -->
      <div class="footer-map">
        <iframe 
          src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3827.123456789012!2d-96.12345678901234!3d16.98765432109876!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x0%3A0x0!2zMTbCsDU5JzE1LjQiTiA5NMKwMzcnMDMuNCJX!5e0!3m2!1ses!2smx!4v1234567890123!5m2!1ses!2smx"
          allowfullscreen>
        </iframe>
      </div>
    </div>
    
    <!-- Derechos reservados -->
    <div class="footer-copyright">
      <p>© 2023 Tecnológico Nacional de México - Santa María Tlahuitoltepec. Todos los derechos reservados.</p>
    </div>
  </footer>
</div>

<!-- Icono de usuario flotante -->
<div id="iconoPerfilContainer">
  <i class="fas fa-user-circle" id="iconoPerfil"></i>
</div>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>


<script>
  document.addEventListener("DOMContentLoaded", function () {
    // 1. Cargar datos del usuario desde JSON
    function cargarUsuario() {
      fetch("php/obtener_usuario.php")
        .then((response) => {
          if (!response.ok) throw new Error("Error en la respuesta del servidor");
          return response.json();
        })
        .then((data) => {
          if (data && typeof data === "object" && !Array.isArray(data)) {
            document.getElementById("nombre-usuario").textContent = data.nombre || "Usuario";
          } else {
            throw new Error("Respuesta JSON no válida");
          }
        })
        .catch((error) => {
          console.error("Error al cargar usuario:", error);
          document.getElementById("nombre-usuario").textContent = "Usuario";
        });
    }

    // 2. Menú hamburguesa
    function setupSidebarToggle() {
      document.getElementById("toggle-sidebar").addEventListener("click", function () {
        document.querySelector(".sidebar").classList.toggle("active");
        document.querySelector(".main-content").classList.toggle("active");
      });
    }

    // 3. Llenar tabla de alumnos
    function llenarTablas() {
      fetch('php/obtener_alumnos.php')
        .then(response => {
          if (!response.ok) {
            throw new Error('Error en la respuesta del servidor');
          }
          return response.json();
        })
        .then(data => {
          console.log('Datos recibidos:', data);
          const tablaCuerpo = document.getElementById('tabla-cuerpo');
          tablaCuerpo.innerHTML = '';
          
          data.forEach((alumno, index) => {
            const row = document.createElement('tr');
            row.innerHTML = `
              <td>${index + 1}</td>
              <td>${alumno.nombre || ''}</td>
              <td>${alumno.numero_control || ''}</td>
              <td>${alumno.carrera || ''}</td>
              <td>${alumno.semestre || ''}</td>
              <td></td>
              <td></td>
            `;
            tablaCuerpo.appendChild(row);
          });
          
          for (let i = data.length; i < 15; i++) {
            const emptyRow = document.createElement('tr');
            emptyRow.innerHTML = `
              <td>${i + 1}</td>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
            `;
            tablaCuerpo.appendChild(emptyRow);
          }
        })
        .catch(error => {
          console.error('Error al obtener datos:', error);
          alert('Error al cargar los datos de los alumnos. Por favor, intente más tarde.');
        });
    }

    // 4. Modal de perfil
    function mostrarModalPerfil() {
      if (document.getElementById('modalPerfilUsuario')) return;

      const usuarioActual = sessionStorage.getItem('usuario') || 'Usuario Invitado';

      const modalHTML = `
        <div id="modalPerfilUsuario" style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0,0,0,0.5); z-index: 9999; display: flex; align-items: center; justify-content: center;">
          <div style="background: #fff; border-radius: 12px; padding: 30px 40px; min-width: 300px; box-shadow: 0 8px 24px rgba(0,0,0,0.2); text-align: center; position: relative;">
            <i class="fas fa-user-circle" style="font-size: 60px; color: #1B396A; margin-bottom: 15px;"></i>
            <h2 style="color: #1B396A; font-size: 22px; margin-bottom: 10px;">Perfil de Usuario</h2>
            <p style="font-size: 17px; margin-bottom: 25px;"><strong>${usuarioActual}</strong></p>
            <button id="btnCerrarSesion" style="background: #d33; color: #fff; border: none; border-radius: 5px; padding: 10px 25px; font-size: 16px; font-weight: bold; cursor: pointer;">
              <i class="fas fa-sign-out-alt" style="margin-right: 7px;"></i>Cerrar Sesión
            </button>
            <button id="btnCerrarModalPerfil" style="position: absolute; top: 10px; right: 15px; background: none; border: none; font-size: 22px; color: #888; cursor: pointer;">&times;</button>
          </div>
        </div>
      `;
      document.body.insertAdjacentHTML('beforeend', modalHTML);

      document.getElementById('btnCerrarSesion').onclick = function() {
        sessionStorage.clear();
        window.location.href = '../index.html';
      };

      document.getElementById('btnCerrarModalPerfil').onclick = function() {
        document.getElementById('modalPerfilUsuario').remove();
      };

      document.getElementById('modalPerfilUsuario').onclick = function(e) {
        if (e.target === this) this.remove();
      };
    }

    // Inicializar
    function init() {
      cargarUsuario();
      setupSidebarToggle();
      llenarTablas();

      // Resaltar enlace activo en el menú lateral
      document.querySelectorAll('.sidebar-menu a').forEach(link => {
        const linkHref = link.getAttribute('href');
        const currentPage = window.location.pathname.split('/').pop();

        if (linkHref === currentPage) {
          link.classList.add('active');
        } else {
          link.classList.remove('active');
        }
      });

      // Evento para icono de perfil
      const iconoPerfil = document.getElementById('iconoPerfil');
      if (iconoPerfil) {
        iconoPerfil.addEventListener('click', mostrarModalPerfil);
      }
    }

    init();
  });
//inicio

document.addEventListener("DOMContentLoaded", function () {
  // Redirección dinámica del enlace "Inicio"
  const linkInicio = document.getElementById("link-inicio");

  if (linkInicio) {
    const unidad = sessionStorage.getItem("unidad_academica");
    let ruta = "index.html"; // Valor por defecto

    switch (unidad) {
      case "CIDERS Unión Hidalgo":
        ruta = "U_CentrodeInvestigacion.html";
        break;
      case "Unidad Demetrio Vallejo en el Espinal":
        ruta = "U_Demetrio.html";
        break;
      case "Unidad académica Tlahuitoltepec":
        ruta = "U_SantaMaria.html";
        break;
      case "Valle de Etla":
        ruta = "U_ValleEtla.html";
        break;
    }

    linkInicio.setAttribute("href", ruta);
  }
});


</script>

</body>
</html>